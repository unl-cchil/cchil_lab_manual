<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Project and data management – CCHIL Lab Manual</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./version_control.html" rel="next">
<link href="./experiments.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./experiments.html">Lab projects</a></li><li class="breadcrumb-item"><a href="./project_data_management.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Project and data management</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CCHIL Lab Manual</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the lab</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Lab policies</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Roles and expectations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./behavior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Behavior and communication</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./onboarding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Onboarding and offboarding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Logistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Lab projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Experimental protocols</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_data_management.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Project and data management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./version_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Version control with Git</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./writing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Writing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./presenting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Presenting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#project-management" id="toc-project-management" class="nav-link active" data-scroll-target="#project-management"><span class="header-section-number">6.1</span> Project management</a>
  <ul class="collapse">
  <li><a href="#project-directory-structure" id="toc-project-directory-structure" class="nav-link" data-scroll-target="#project-directory-structure"><span class="header-section-number">6.1.1</span> Project directory structure</a></li>
  <li><a href="#existing-projects" id="toc-existing-projects" class="nav-link" data-scroll-target="#existing-projects"><span class="header-section-number">6.1.2</span> Existing projects</a></li>
  <li><a href="#rstudio-projects" id="toc-rstudio-projects" class="nav-link" data-scroll-target="#rstudio-projects"><span class="header-section-number">6.1.3</span> RStudio Projects</a></li>
  </ul></li>
  <li><a href="#project-workflow" id="toc-project-workflow" class="nav-link" data-scroll-target="#project-workflow"><span class="header-section-number">6.2</span> Project workflow</a>
  <ul class="collapse">
  <li><a href="#pre-registration" id="toc-pre-registration" class="nav-link" data-scroll-target="#pre-registration"><span class="header-section-number">6.2.1</span> Pre-registration</a></li>
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection"><span class="header-section-number">6.2.2</span> Data collection</a></li>
  <li><a href="#raw-data" id="toc-raw-data" class="nav-link" data-scroll-target="#raw-data"><span class="header-section-number">6.2.3</span> Raw data</a></li>
  <li><a href="#data-processing" id="toc-data-processing" class="nav-link" data-scroll-target="#data-processing"><span class="header-section-number">6.2.4</span> Data processing</a></li>
  <li><a href="#working-data" id="toc-working-data" class="nav-link" data-scroll-target="#working-data"><span class="header-section-number">6.2.5</span> Working data</a></li>
  <li><a href="#analysis_script" id="toc-analysis_script" class="nav-link" data-scroll-target="#analysis_script"><span class="header-section-number">6.2.6</span> Data analysis</a></li>
  </ul></li>
  <li><a href="#reproducible" id="toc-reproducible" class="nav-link" data-scroll-target="#reproducible"><span class="header-section-number">6.3</span> Reproducible research and open science</a>
  <ul class="collapse">
  <li><a href="#coding" id="toc-coding" class="nav-link" data-scroll-target="#coding"><span class="header-section-number">6.3.1</span> Coding</a></li>
  <li><a href="#documentation" id="toc-documentation" class="nav-link" data-scroll-target="#documentation"><span class="header-section-number">6.3.2</span> Documentation</a></li>
  <li><a href="#r-markdownquarto" id="toc-r-markdownquarto" class="nav-link" data-scroll-target="#r-markdownquarto"><span class="header-section-number">6.3.3</span> R Markdown/Quarto</a></li>
  <li><a href="#dissemination" id="toc-dissemination" class="nav-link" data-scroll-target="#dissemination"><span class="header-section-number">6.3.4</span> Dissemination</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./experiments.html">Lab projects</a></li><li class="breadcrumb-item"><a href="./project_data_management.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Project and data management</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="project_data_management" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Project and data management</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="project-management" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="project-management"><span class="header-section-number">6.1</span> Project management</h2>
<section id="project-directory-structure" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="project-directory-structure"><span class="header-section-number">6.1.1</span> Project directory structure</h3>
<p>The lab uses a consistent project management style to facilitate collaboration across members and to facilitate the open dissemination of our work. To participate in data analysis or manuscript preparation, you will need to organize the files on your local computer with a particular structure to match the lab’s structure. If you do not have one already, you should create a <code>projects</code> or <code>research</code> or <code>CCHIL work</code> directory on your computer. We highly recommend creating this directory with your Microsoft OneDrive folder on your computer.</p>
<p>Once you have an overall projects directory in place, you can create a subdirectory for the current project. Within the project directory, you will want to use the following subdirectory structure:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/project_directory.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:25.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><code>admin</code> This is the administrative directory that should contain information about IRB protocols, IACUC protocols, pre-registration documents, experimental protocols, and other files associated with the logistics of the project. It also has a file called <code>project_log.md</code> that is a log of the event associated with the project.</li>
<li><code>code</code> This is the directory for the computer code that is used to collect data. For example, there might be Python, PsychoPy, or OpenSesame code here. Not all projects have a code directory.</li>
<li><code>data</code> This is the directory that stores the project data. Often there is a subdirectory called <code>raw_data</code> for raw data.</li>
<li><code>docs</code> This is the document directory that stores the files for manuscripts and presentations (posters and talks). This is where most <code>Rmd</code> files go. We do not place administrative documents here—only documents for disseminating our results.</li>
<li><code>figures</code> This is the directory for hand-drawn and script-generated figures.</li>
<li><code>R</code> This is the directory that contains the data analysis scripts. In general, there should be a data processing script and a data analysis script.</li>
<li><code>CITATION.md</code> This file gives the citation for the published version of the project (e.g., journal citation).</li>
<li><code>LICENSE.md</code> This file describes the license under which the project is published (e.g., <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Public License</a>).</li>
<li><code>README.md</code> This file give a short overview of the project and is the landing page for the project on GitHub.</li>
</ul>
<p>In general, use subdirectories to organize the main directories and limit the files in the main directories to just the core files. We will often create <code>old</code> subdirectories to move old or irrelevant files into.</p>
</section>
<section id="existing-projects" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="existing-projects"><span class="header-section-number">6.1.2</span> Existing projects</h3>
<p>Most projects in the lab already have project directories, and they are available to collaborators in the lab. These directories are available as <a href="https://git-scm.com/">Git</a> <a href="https://help.github.com/en/github/getting-started-with-github/github-glossary#repository">repositories</a> (repos) at <a href="https://www.github.com">GitHub</a>, a website that stores, backs up, and version controls code. Git is a very powerful tool for tracking changes that happen to files, and GitHub is a great way to facilitate online collaboration. Briefly, GitHub allows you to <a href="https://help.github.com/en/github/getting-started-with-github/github-glossary#clone">clone</a> (install new) existing repos from the <a href="https://help.github.com/en/github/getting-started-with-github/github-glossary#remote">remote</a> GitHub source to your local computer, <a href="https://help.github.com/en/github/getting-started-with-github/github-glossary#pull">pull</a> changes from a remote repo to update your local repo, and <a href="https://help.github.com/en/github/getting-started-with-github/github-glossary#push">push</a> changes you make locally up to the remote repo. Check out <a href="https://help.github.com/en/github/getting-started-with-github/github-glossary">Github’s glossary</a> for more definitions. To learn more about working with Git, check out the <a href="version_control.html">Version control</a> section.</p>
<p>So if you want access to the project directories, you need to create a GitHub account and send Jeff your GitHub account name. Once you’re added to the lab team as a contributor, you can clone the repo locally to your own computer and start working on the files.</p>
<p>Note that GitHub does not automatically sync your computer with the remote repo. This is done for two reasons: (1) multiple people can be working on a file at a time, which can cause conflicts and (2) project manager may want control over what changes are accepted and rejected. Therefore, you must manually pull changes from the remote repo that other people have pushed there. <strong>Please always pull from the remote repo everytime before you start working on a project.</strong> Also, when you make changes to files on your local repo, you must manually push them to the remote repo. In some cases, your pushes will be automatically accepted. But in other cases, your pushes must be reviewed by the repo maintainer to make sure that they are acceptable.</p>
</section>
<section id="rstudio-projects" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="rstudio-projects"><span class="header-section-number">6.1.3</span> RStudio Projects</h3>
<p>Because most of our analyses and documents are done in RStudio, we use <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">RStudio Projects</a> for our projects. Creating an RStudio Project sets the working directory in RStudio to the project’s root directory. This is useful because when you open an RStudio Project, you always know what working directory you are using. Combined with the functionality of the <code>here()</code> function of the <a href="https://here.r-lib.org/"><code>{here}</code></a> package, you will not have to spend any time worried about setting directories with an RStudio Project.</p>
<p>RStudio Projects also will automatically open the documents that were opened last time that you used the Project. Finally, you must work in an RStudio Project to be able to use version control via Git in RStudio.</p>
<p>So you should create an RStudio Project for every project that you will be using RStudio for. To open the RStudio Project, double click on the <code>.Rproj</code> file in your project root directory (do not open RStudio through the app menu).</p>
</section>
</section>
<section id="project-workflow" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="project-workflow"><span class="header-section-number">6.2</span> Project workflow</h2>
<p>The way in which we manage our project workflow can (1) maintain consistency and facilitate collaboration across the lab, (2) ensure more robust scientific practices, and (3) encourage open science and facilitate publishing our work in a reproducible way. Therefore, the lab uses consistent tools and steps to maintain a reproducible project workflow. In general, our lab</p>
<ol type="1">
<li>pre-registers our studies,</li>
<li>collects data in an open manner (using open-source software when possible),</li>
<li>archives raw data without alteration,</li>
<li>uses R to process that raw data,</li>
<li>generates ‘working data sets’,</li>
<li>uses R to analyze working data to calculate descriptive statistics, conduct statistical tests, and generate figures,</li>
<li>uses R Markdown to produce manuscripts and presentations to disseminate our work,</li>
<li>posts our data collection materials, working data sets, R analysis scripts, and R Markdown documents with our published articles.</li>
</ol>
<p>This workflow needs to be in place for all CCHIL lab members. However, the workflow is not immutable—if you have suggestions on ways to improve it, let Jeff know. Though imposing our structure on collaborators is not feasible, we will try to maintain our project workflow as much as possible with people outside of the lab.</p>
<section id="pre-registration" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="pre-registration"><span class="header-section-number">6.2.1</span> Pre-registration</h3>
<p>One way to improve replicability of our studies is to <a href="https://www.cos.io/prereg">pre-register</a> them <span class="citation" data-cites="Nosek.etal.2019">(<a href="references.html#ref-Nosek.etal.2019" role="doc-biblioref">Nosek et al. 2019</a>)</span>. Pre-registration means that you write down and post your plan for methods, data collection, data processing, and analysis <strong>before starting data collection</strong>. Pre-registration forces you to think about how you will analyze your data before you have any. This both helps in designing your data collection tools and limits the degrees of freedom available for <a href="https://psychology.wikia.org/wiki/P-hacking">p-hacking</a> at the analysis step.</p>
<p>There are a number of different ways to pre-register a study. This simplest is to complete the nine-question form at <a href="https://aspredicted.org/">AsPredicted.org</a>. Alternatively, the <a href="https://osf.io/prereg/">Open Science Framework pre-registration system</a> provides a more thorough avenue to pre-register your study. I highly recommend using the <a href="https://github.com/crsh/prereg"><code>{prereg}</code></a> package to create your pre-registration in R Markdown before submitting. However you choose to do so, you will need to pre-register your studies before starting data collection.</p>
</section>
<section id="data-collection" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="data-collection"><span class="header-section-number">6.2.2</span> Data collection</h3>
<p>When designing data collection tools (e.g., Qualtrics surveys, PsychoPy scripts, etc.), it is important to think about how the data will be used downstream in the work flow. So before designing data collection, make sure to understand the rest of the workflow and think carefully about how the information you collect will be used in the workflow. Take the time to carefully design these tools to facilitate easier data analysis.</p>
<section id="standard-practices-for-data-files" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="standard-practices-for-data-files">Standard practices for data files</h4>
<ul>
<li>Organize data files logically and separate them into subdirectories if appropriate.</li>
<li>Save data files as <code>csv</code> (comma-separated value) files. In general, use plain text files (<code>txt</code>, <code>md</code>) as much as possible. Avoid using Excel and Word files when possible.</li>
<li>Name files consistently. In general, <a href="https://en.wikipedia.org/wiki/Snake_case">‘snake_case’</a> (that is, lower case with an underscore between words: <code>response_time</code>) works best. Avoid uppercase letters and spaces in file names. If possible, use a script to automatically name files consistently. If appending a date, use proper ISO standard dates: YYYY-MM-DD (e.g., <code>my_file-2020-05-22.csv</code>)</li>
<li>Within data files, use descriptive variable names written in snake_case. Abbreviations are acceptable, but make sure that they are readable and understandable. Do not use upper case letters or spaces in variable names.</li>
<li>Think carefully about how the data values should be labeled, considering how you will be working with those values in R. For instance, avoid using spaces in value labels (use snake_case when possible). For example, do you want to use words (e.g., Yes/No, LL/SS) which are more descriptive or numbers (e.g., 1/0) which can be used to calculate proportions directly?</li>
<li>Use the proper ISO standard for dates and times: YYYY-MM-DD hh:mm:ss (e.g., 2020-05-20 09:48:00) or just YYYY-MM-DD for dates.</li>
<li>Avoid collecting identifiable data when possible. And ensure that you are only collecting data that you have IRB permission to collect. For instance, in Qualtrics, unless you requested permission to do so, you must disable the recording of particpant IP address (<em>Survey Options &gt; Security &gt; Anonymize Response</em>).</li>
</ul>
</section>
<section id="data-security" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="data-security">Data security</h4>
<p>In addition to attending to the structure of data collection, take the time to ensure data security.</p>
<ul>
<li>Only store data files on password-protected computers. If you must use shared computers, transfer the data files to OneDrive, double check that they are all uploaded to OneDrive, delete them from the shared computer, and empty them from the trash. <strong>You cannot store data with personally identifiable information on personal computers. They can only be stored on lab computers.</strong></li>
<li>Do not leave publicly accessible computers unlocked. For example, if you are working in the B71 bullpen or the library or a coffee shop, do not leave your computer unattended and unlocked. Lock your screen.</li>
<li>Do not share any lab passwords outside the lab, and do not leave passwords visible to others.</li>
<li>Do not upload data (especially participant-related information) to any cloud storage systems besides OneDrive (e.g., not Google Drive). We only have permission to store data in OneDrive.</li>
<li>Do not make or use public GitHub repos until all data analyses are public, and the PI has authorized making the repo public.</li>
</ul>
</section>
</section>
<section id="raw-data" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="raw-data"><span class="header-section-number">6.2.3</span> Raw data</h3>
<p>All raw data should either be automatically saved to a cloud storage service or should be moved there as soon as possible. Currently, the lab uses OneDrive to store all raw data, and each project should have its own OneDrive folder that is shared with all of the project members. Note that OneDrive raw data folders do not necessarily have to be synced onto your local computer.</p>
<p>Note that we are using OneDrive as an archive for all raw data. That means that <strong>all</strong> raw data need to be archived on OneDrive, even if it is a ‘bad’ data file (e.g., incomplete data, interrupted session, wrong subject/date entered, etc.). If necessary, a subdirectory for ‘bad’ data can be created and these files can be moved there. But every data file created must be archived on OneDrive.</p>
<p>Because this is an archive of the data, <strong>we do not EVER alter the raw data files, including the file names</strong>. Any changes that need to be made to data must happen downstream in the R scripts. Raw data should never be changed. If changes need to be made, they need to be entered into the <code>project_log.md</code> file and a separate notes file (if desired).</p>
<p>OneDrive files are versioned (meaning it saves previous versions) and authored (meaning we can see who made changes). So we can revert to previous versions, but this should not need to happen. Do not change raw data files.</p>
</section>
<section id="data-processing" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="data-processing"><span class="header-section-number">6.2.4</span> Data processing</h3>
<p>In the lab, all data processing occurs transparently via R. <strong>Never change any data files in Excel.</strong> While Excel saves the changes that you make to files, it does not save the <em>process</em> of that change. Our lab prioritizes making the entire data analysis workflow transparent, and Excel does not allow transparency, so it is not allowed to be a part of our workflow.</p>
<p>To achieve this, we usually have a single R script called something like <code>data_processing.R</code>. This script inputs the raw data and processes it to generate the working data set that will be published with the article.</p>
<ul>
<li>Fix some of the problems with data files that occurred at data collection (e.g., fix wrong subject number/date).</li>
<li>Combine separate subject-specific files into single data set.</li>
<li>Remove unnecessary columns and rename and reorder existing columns.</li>
<li>Recode data values.</li>
<li>Convert dates into ISO if not recorded that way.</li>
<li>Pivot data into <a href="how to handle data protection and security">tidy</a> format (if that is appropriate).</li>
<li>Merge different data files into single file.</li>
</ul>
<p>Note the only aim of this script is to generate a publication-ready working data set. <strong>There should be no analysis conducted in this script.</strong> Every statistic in the manuscript should come from the <a href="#analysis_script">analysis script</a>. While the data processing script does need to be commented and documented, it does not need to be as polished as the analysis script.</p>
</section>
<section id="working-data" class="level3" data-number="6.2.5">
<h3 data-number="6.2.5" class="anchored" data-anchor-id="working-data"><span class="header-section-number">6.2.5</span> Working data</h3>
<p>The working data set is the data file (or files) that will be posted with the published article. As such, it needs to be clean and polished. Ideally, there is only a single working data set, so try to merge different data sets together in the data processing script. If that is not possible, multiple working data sets are acceptable, but try to minimize the number of working data sets.</p>
<p>Characteristics of working data sets:</p>
<ul>
<li>These files should only include the columns that are relevant to the subsequent data analysis.</li>
<li>Include dates and times when possible.</li>
<li>Make sure that the column names are both human and R readable—meaning they are understandable to people but are easy for R to work with (e.g., snake_case).</li>
</ul>
</section>
<section id="analysis_script" class="level3" data-number="6.2.6">
<h3 data-number="6.2.6" class="anchored" data-anchor-id="analysis_script"><span class="header-section-number">6.2.6</span> Data analysis</h3>
<p>There should be a single data analysis script for one article manuscript (that will be published with that manuscript). If multiple scripts were created during data analysis, they should be combined into a single script. It should contain the code for <strong>all</strong> of the analyses in the manuscript. If there are analyses that cannot be run in R, this should be made clear in the manuscript. It should not contain code that is not contained or referenced in the manuscript. Save unused analyses in other scripts.</p>
<p>In general, the analysis script should use the <a href="https://www.tidyverse.org/">tidyverse</a> system of working with, analyzing, and plotting data. The data analysis script should contain the following in this order:</p>
<ul>
<li>A <a href="../examples/r-header.txt">header</a> that includes the name of the script, the purpose of the script, the author(s) of the script, the date that the script was started, the date of the current version of the script, the license under which the script is published, notes on how to run the script, a list of data files, and a description of all of the columns in the data files.</li>
<li>A list of packages to load at the very beginning of the script. In general, it is recommended to order the scripts alphabetically unless function masking necessitates another order (e.g., <code>{here}</code> should go last and <code>{tidyverse}</code> second to last). For packages with a single use or only a few uses, include this in a comment after loading the package. Minimize the number of packages loaded for your script.</li>
<li>A list of custom-coded functions needed for your analysis. Name your function using <a href="https://r4ds.had.co.nz/functions.html#functions-are-for-humans-and-computers">tidyverse style</a>: “Ideally, the name of your function will be short, but clearly evoke what the function does. … Generally, function names should be verbs, and arguments should be nouns.”</li>
<li>Import the working data file. If you are using an RStudio project (which you should be!), the <code>{here}</code> package is useful for setting working directories properly in RStudio. Use the <code>here</code> function when setting the path to import your data.</li>
<li>Calculate descriptive statistics of participants/subjects, such as age, gender/sex, and other demographic variables. For human participant studies, this should generate a demographic information table for the supplementary materials.</li>
<li>Calculate inferential statistics. Typically, we calculate and report frequentist statistics, Bayes factors, and effect sizes. We also report the key means <span class="math inline">\(\pm\)</span> 95% confidence intervals (either between- or within-subjects) and place the model assumption checks here.</li>
<li>Plots can either be carved out as a separate section or integrated in with the inferential statistics. Having a separate section is often nice because someone can run the rest of the script without saving new plots, which changes the files and requires them to be staged and updated in the Git commit. Use <code>{ggplot2}</code> or <code>ggplot</code> extension packages to make plots when possible.</li>
<li>Create a separate section at the end for supplemental tables and figures.</li>
</ul>
<section id="high-computation-analyses" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="high-computation-analyses">High-computation analyses</h4>
<p>Sometimes, our analyses can require extensive computations that can take a long time to run. While working through the data analysis, I will often have these scripts write their output to a data file. Then I will comment out the high-computation code and simply import the data file. This will greatly speed up the sourcing of the full R script.</p>
<p>For the final version of the script, however, you will need to uncomment the code and remove the write and read commands. I usually add a comment before the high-computation code warning the user that the code will take a while to process.</p>
</section>
</section>
</section>
<section id="reproducible" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="reproducible"><span class="header-section-number">6.3</span> Reproducible research and open science</h2>
<p>The lab’s policy is to generate reproducible research—that is, we provide the experimental code, working data, R analysis script, and manuscript file used to generate the final document. This allows other researchers to rerun our studies, rerun our code, or reanalyze our data. While it can be scary to put our work out there for public scrutiny, this is what science is about. It can be uncomfortable to have others scrutinize our work. But the benefits of having someone detect an error and correcting the scientific record is more important than our individual egos. We need to be comfortable saying that we were wrong.</p>
<section id="coding" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="coding"><span class="header-section-number">6.3.1</span> Coding</h3>
<p>We should write our code assuming that someone else will be reading it. This is guaranteed to happen when future you revisits the code after taking a break. But we should also assume that a different person will be looking at the code.</p>
<section id="coding-principles" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="coding-principles">Coding principles</h4>
<ul>
<li>Write the code as concisely and simply as possible.</li>
<li>Break your code into logical sections. RStudio allows you to create sections in R scripts with <code>ctrl+shift+R</code>.</li>
<li>Use functions to automate repetitive tasks. As <code>{tidyverse}</code> author Hadley Wickham recommends, you should write a function if you have to do something <a href="https://r4ds.had.co.nz/functions.html#when-should-you-write-a-function">three or more times</a> <span class="citation" data-cites="Wickham.Grolemund.2017">(<a href="references.html#ref-Wickham.Grolemund.2017" role="doc-biblioref">Wickham and Grolemund 2017</a>)</span>.</li>
<li>Use comments <strong>a lot</strong> and comment as you are writing the code. Don’t wait to comment afterwards. I tend to use comments as subsections to describe conceptually what a block of code does as well as after almost every line to specify the function of that line.</li>
<li>Use <a href="version_control.html">version control</a> to maintain updates of code.</li>
</ul>
<p>Here are some R-specific coding principles:</p>
<ul>
<li>Use <code>&lt;-</code> as assignment operator.</li>
<li>Use short but descriptive variable names.</li>
<li>In variable names, separate words with _ or . (e.g., <code>my_vector</code>).</li>
<li>Don’t use functions as variable names (e.g., <code>c</code>, <code>mean</code>).</li>
<li>Use blank space between all objects, operators (<code>*</code>, <code>=</code>, <code>==</code>), and after all commas</li>
<li>Write out <code>TRUE</code> and <code>FALSE</code>.</li>
<li>Use indents to separate nested components. Highlighting text and pressing <code>ctrl+I</code> will automatically indent code properly.</li>
</ul>
</section>
</section>
<section id="documentation" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="documentation"><span class="header-section-number">6.3.2</span> Documentation</h3>
<p>In addition to commenting code, documentation is important to maintaining reproducible research.</p>
<p>First, creating and updating a project log is important. The <code>project_log.md</code> file in a project’s <code>admin</code> folder is the best place to start for this (here’s an <a href="../examples/project_log.md">example project log</a>). The log simply comprises a date and a description of the what happened in the project that day. Entries for these logs can include IRB/IACUC approval dates and protocol numbers, experiment start/pause/stop dates, experiment assistant start/stop dates, anomalous data descriptions (e.g., “program stopped while subject was running, so I restarted it and labelled it subject 102b”). While it may seem tedious, and you may forget to add entries, updating the project log is critical to keep track of issues that may be relevant to data analysis and interpretation, especially months or years after the issues occurred. The project log should be used from the inception of the project, through data collection, data analysis, and manuscript preparation. It can be closed upon final publication.</p>
<p>Second, README files are important for documenting the structure and process of a study project. There is a <code>README.md</code> in the root directory of every project. This file should include the project name and overview, a list of specific aims and research questions, and a project protocol describing the structure of the project and the expectations for working on the project. This should be updated to include the citation and abstract of the accepted manuscript when the project is published. This file is what shows up on the main page of the GitHub repo for the project.</p>
<p>Once a project is ready for submission, there should also be a <code>README.md</code> file added to the reproducible research folder. This file should include the author(s) and creation date of the file, a request for a citation of the manuscript, the license under which the script is published, notes on how to compile the file/run the script, a short summary of the data and data processing, a list of data files, a description of all of the columns in the data files, a list of R scripts.</p>
</section>
<section id="r-markdownquarto" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="r-markdownquarto"><span class="header-section-number">6.3.3</span> R Markdown/Quarto</h3>
<p>Though it is the worldwide standard and it has some advantages such as track changes, Microsoft Word has limitations for reproducible research because you cannot embed R code into the text to show how statistics are calculated. <a href="https://rmarkdown.rstudio.com/">R Markdown</a> allows the inclusion of R code into manuscripts and can produce beautiful documents. A key benefit of this is that, if your statistics change (because you have altered the R script), you do not have to change them by hand in the document. R Markdown will automatically update them. <strong>The standard for the lab is to use R Markdown for all publications</strong>. There may be cases in which we do not use R Markdown (e.g., working with collaborators outside of the lab), but it should be the default method for writing manuscripts. And I highly recommend using <a href="https://github.com/crsh/papaja"><code>{papaja}</code></a> to format APA style manuscripts.</p>
<p>To use R Markdown, you will edit a plain-text <code>.Rmd</code> file that uses <a href="https://daringfireball.net/projects/markdown/">Markdown</a> syntax to format text and R code chunks to embed R calculations. In RStudio, you can then compile this file using the <code>{knitr}</code> package to generate a PDF of your document. It takes a bit of time to learn Markdown and R Markdown syntax, but the time invested is worth it to generate elegant, reproducible, updatable manuscripts. You can find <a href="https://decisionslab.unl.edu/data/duque_etal_2020_rr.zip">example R Markdown files</a> on the <a href="https://jeffreyrstevens.quarto.pub/publications.html">lab’s publications page</a> and check out <a href="https://bookdown.org/yihui/rmarkdown/">R Markdown: The Definitive Guide</a> <span class="citation" data-cites="Xie.etal.2018">(<a href="references.html#ref-Xie.etal.2018" role="doc-biblioref">Xie, Allaire, and Grolemund 2018</a>)</span>.</p>
<p><a href="https://quarto.org">Quarto</a> is the next generation of R Markdown. While it’s great for presentation and websites, there currently isn’t a robust template for making APA-formatted journal articles, so I don’t recommend using it for manuscripts just yet.</p>
</section>
<section id="dissemination" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4" class="anchored" data-anchor-id="dissemination"><span class="header-section-number">6.3.4</span> Dissemination</h3>
<p>To disseminate our reproducible research, we must collect all of the relevant files in a cohesive way. Therefore, we need to create a subdirectory in the <code>docs</code> directory called <code>rr</code> or <code>osf</code> or <code>dryad</code>. Within this directory, we need to place the following:</p>
<ul>
<li>Data files (<code>.csv</code> files)</li>
<li>R scripts</li>
<li>R Markdown files for manuscript and supplementary materials</li>
<li>Bibliography and style files used by R Markdown files</li>
<li>README file</li>
</ul>
<p>We usually do not start formally collecting these files until after data analysis and manuscript preparation are complete. But it is important to keep this in mind as you build and work on the project.</p>
<section id="open-science-framework" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="open-science-framework">Open Science Framework</h4>
<p>Once the reproducible research files are in place, they can easily be uploaded to an <a href="https://osf.io">Open Science Framework (OSF)</a> project, which provides a permanent place to archive the files. OSF projects need to include the major authors as collaborators. The lead author should write a description of the project, choose a license, and add the citation, abstract, and keywords to the project wiki. Then the following components should be added: <em>Data and R script</em>, <em>Figures and tables</em>, and <em>Preprint.</em> Then, upload the data file and R script to <em>Data and R script</em>, primary and supplementary tables and figures to <em>Figures and tables</em>, and the PDF and R Markdown files for the manuscript and supplementary materials to <em>Preprints</em>. Separating the files into different components allows us to (1) allow differential public access and (2) create separate DOIs for different parts. For example,</p>
</section>
<section id="figures" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="figures">Figures</h4>
<p>When you publish figures in your journal articles or books, the publisher owns the copyright to those figures and may require written permission for others or you to republish them. To avoid this, I recommend publishing the figures yourself first under a license that allows anyone to reuse the figures as long as they cite the source (e.g., <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Public License</a>). One way to publish your figures is to create a component in your <a href="https://osf.io">Open Science Framework</a> project for figures and tables, post your figures and tables there under an appropriate licence, and create a DOI for that OSF component. Then create a citation to this component (e.g., Goh, F. W., Jungck, A. C., &amp; Stevens, J. R. (2020). Payment method effects on tipping: Figures and tables. Open Science Framework. https://doi.org/10.17605/OSF.IO/6FMVS) and add something like the following to the end of each figure caption in your manuscript: “Figure used with permission: Goh et al., 2020; available at https://doi.org/10.17605/OSF.IO/6FMVS under a CC-BY4.0 license”.</p>
</section>
<section id="preprints" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="preprints">Preprints</h4>
<p>The lab strives to produce and post preprints of manuscript prior to submission to journals. Posting preprints makes your information public much sooner than waiting for journal publication. While it may seem scary to post your work before it has been peer reviewed, this allows you to get feedback early, gives you credit for work early, and makes your work open and accessible to anyone. You can (and should) update your preprints as changes are made to the manuscript. Check with a <a href="https://v2.sherpa.ac.uk/romeo/">journal’s preprint policy</a> before submitting to them. Most journals are fine with preprints (some even allow you to submit to them directly from the preprint server). But some have weird policies. Do not submit your manuscript to journals that do not allow preprints.</p>
<p>For our purposes, there are two primary preprint servers. <a href="https://psyarxiv.com/">PsyArXiv</a> focuses on psychology-related content and is associated with the OSF. In fact, you can import files directly from your OSF projects. <a href="https://www.biorxiv.org/">BioRxiv</a> focuses on biology-related content and has direct connections to many biology journals.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Nosek.etal.2019" class="csl-entry" role="listitem">
Nosek, Brian A., Emorie D. Beck, Lorne Campbell, Jessica K. Flake, Tom E. Hardwicke, David T. Mellor, Anna E. van ’t Veer, and Simine Vazire. 2019. <span>“Preregistration Is Hard, and Worthwhile.”</span> <em>Trends in Cognitive Sciences</em> 23 (10): 815–18. <a href="https://doi.org/10.1016/j.tics.2019.07.009">https://doi.org/10.1016/j.tics.2019.07.009</a>.
</div>
<div id="ref-Wickham.Grolemund.2017" class="csl-entry" role="listitem">
Wickham, Hadley, and Garrett Grolemund. 2017. <em>R for <span>Data Science</span></em>. <span>O’Reilly Media</span>.
</div>
<div id="ref-Xie.etal.2018" class="csl-entry" role="listitem">
Xie, Y, J J Allaire, and G Grolemund. 2018. <em>R <span>Markdown</span>: <span>The Definitive Guide</span></em>. <span>Chapman and Hall</span>.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./experiments.html" class="pagination-link" aria-label="Experimental protocols">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Experimental protocols</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./version_control.html" class="pagination-link" aria-label="Version control with Git">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Version control with Git</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>